(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{133:function(e,t,a){e.exports=a(183)},138:function(e,t,a){},139:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},146:function(e,t,a){},148:function(e,t,a){},178:function(e,t){},181:function(e,t,a){},182:function(e,t,a){},183:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(11),c=a.n(o),s=a(30),i=(a(138),a(87)),l=(a(139),a(20)),u=a(21),h=a(27),m=a(26),d=a(247),p=a(250),g=a(229),f=a(111),b=a(4),v=a(3),E=a(222),y=a(225),k=a(226),O=a(227),j=a(249),w=a(228),S=a(37),C=a(74),x=a(67),M=a.n(x),T=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={visible:!1},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){console.log("comp mount"),this.setState({visible:!0})}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(E.a,{className:Object(v.a)(e.root,Object(f.a)({},e.cardVisible,this.state.visible))},r.a.createElement(y.a,{avatar:r.a.createElement(j.a,{"aria-label":"recipe",className:e.avatar}),title:this.props.person.realName,subheader:this.props.person.isFoodProvider?"Volunteer":"Hero"}),r.a.createElement(k.a,null,r.a.createElement(S.a,{variant:"h5",color:"textSecondary",component:"h1",style:{marginBottom:"15px"}},"Location Details"),r.a.createElement(S.a,{variant:"body1",style:{lineHeight:"30px"}},this.props.location.description)),r.a.createElement(O.a,{disableSpacing:!0},r.a.createElement(w.a,{variant:"contained",color:"primary"},r.a.createElement(M.a,null))))}}]),a}(r.a.Component),I=Object(b.a)((function(e){return{root:{width:"28%",zIndex:401,position:"absolute",right:"-100%",transition:e.transitions.create("right",{duration:e.transitions.duration.shortest}),top:"55%",transform:"translateY(-50%)",backgroundColor:"white",boxShadow:"0px 5px 5px rgba(0, 0, 0, 0.25)",borderRadius:"20px",padding:"10px"},media:{height:0,paddingTop:"56.25%"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"},avatar:{backgroundColor:C.a[600],width:"100px",height:"100px"},cardVisible:{right:"3%"}}}))(T),N=a(84),H=a.n(N),L=a(115),P=a(72),R=new P.a;function z(e,t,a,n){fetch(e,t).then(function(){var e=Object(L.a)(H.a.mark((function e(t){var r;return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json().catch((function(e){return console.log("data: `"+r+"` err: "+e)}));case 2:r=e.sent,console.log(r+"\n"+t),e.t0=t.status,e.next=500===e.t0||403===e.t0||401===e.t0||400===e.t0?7:201===e.t0||200===e.t0?10:12;break;case 7:return console.log(t.status),n(r.error.message||("[object Object]"==r.error.toString()?JSON.stringify(r.error):r.error)),e.abrupt("break",14);case 10:return a(r),e.abrupt("break",14);case 12:return n("Something went wrong while contacting the server!"),e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var A={isAuthenticated:function(){return"undefined"!=typeof R.get("token")},authenticate:function(e,t){var a=this;z("/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},(function(e){R.set("token",e.token,{path:"/",expires:function(){var e=new Date;return e.setTime(e.getTime+36e5),e}()}),a.userData=JSON.parse(atob(e.token.split(".")[1])),t(1)}),(function(e){t(0,e)}))},registerUser:function(e,t){z("/api/users/register",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},(function(e){t(1)}),(function(e){t(0,e)}))},logout:function(e){R.remove("token"),e()},getSelfInfo:function(e){z("/api/users/me",{headers:{Authorization:"Bearer "+R.get("token")}},(function(t){e(1,t)}),(function(t){e(0,t)}))},getLocationsFromPosition:function(e,t){z("/api/locations/near?"+new URLSearchParams(e).toString(),{headers:{Authorization:"Bearer "+R.get("token")}},(function(e){t(1,e)}),(function(e){t(0,[{name:"Couldn't find locations"}]),console.error(e)}))},getAllLocations:function(e){z("/api/locations/all",{headers:{Authorization:"Bearer "+R.get("token")}},(function(t){e(1,t)}),(function(t){e(0,[{name:"Couldn't find locations"}]),console.error(t)}))},getUserInformation:function(e,t){z("/api/users/"+e,{headers:{Authorization:"Bearer "+R.get("token")}},(function(e){t(1,e)}),(function(e){t(0,[{name:"Couldn't find user"}]),console.error(e)}))}},D=a(17),U=a.n(D),W=(a(145),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={lat:39.8283,lng:-98.5795,zoom:5,locations:[],currentPerson:null,currentLocation:null,cardVisible:!1},n}return Object(u.a)(a,[{key:"getLocationsFromPosition",value:function(e){var t=this;A.getAllLocations((function(e,a){e&&t.setState({locations:a})}))}},{key:"setCurrent",value:function(e,t){var a=this;A.getUserInformation(e,(function(e,n){e&&(a.setState({currentPerson:n,currentLocation:t}),a.setState({cardVisible:!0}))}))}},{key:"componentWillMount",value:function(){var e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e.setState({lat:t.coords.latitude,lng:t.coords.longitude,zoom:10}),e.getLocationsFromPosition([e.state.lat,e.state.lng])})):this.getLocationsFromPosition([this.state.lat,this.state.lng])}},{key:"render",value:function(){var e=this;console.log("hello this is render");var t=[this.state.lat,this.state.lng];return r.a.createElement("div",{style:{width:"100%",height:"100%"}},this.state.currentPerson?r.a.createElement(I,{person:this.state.currentPerson,location:this.state.currentLocation}):r.a.createElement(r.a.Fragment,null),r.a.createElement(d.a,{center:t,zoom:this.state.zoom,style:{width:"100%",height:"100%"},minZoom:4,onmouseup:function(e){console.log(e.latlng)}},r.a.createElement(p.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),this.state.locations?this.state.locations.map((function(t){return r.a.createElement(g.a,{key:t.userId,position:[t.location.latitude,t.location.longitude],icon:U.a.icon({iconUrl:"/assets/pictures/marker.webp",iconSize:[50,50],iconAnchor:[25,50]}),onclick:function(){return e.setCurrent(t.userId,t)}})})):""))}}]),a}(r.a.Component)),B=a(19),F=a(248),J=a(119),K=a(242),V=a(240),q=a(232),G=a(244),Y=a(12);a(146);function Z(){var e=Object(Y.g)(),t=r.a.useState(""),a=Object(B.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),s=Object(B.a)(c,2),i=s[0],l=s[1],u=r.a.useState(!1),h=Object(B.a)(u,2),m=h[0],d=h[1],p=r.a.useState(""),g=Object(B.a)(p,2),f=g[0],b=g[1],v=r.a.useState("Log In"),E=Object(B.a)(v,2),y=E[0],k=E[1],O=function(e,t){"clickaway"!==t&&d(!1)};return r.a.createElement("div",{className:"container"},r.a.createElement(F.a,{open:m,autoHideDuration:6e3,onClose:O},r.a.createElement(G.a,{onClose:O,severity:"error"},"Error! ",f)),r.a.createElement(J.a,{className:"square",elevation:3,square:!0},r.a.createElement("div",{className:"content"},r.a.createElement(K.a,{display:"flex",style:{height:"100%"},flexDirection:"column",alignItems:"center",justifyContent:"center",className:"box"},r.a.createElement("h1",null,"Login!"),r.a.createElement("div",{className:"buttonContainer"},r.a.createElement(V.a,{placeholder:"Username",onChange:function(e){return o(e.target.value)}}),r.a.createElement(V.a,{placeholder:"Password",type:"password",onChange:function(e){return l(e.target.value)}}),r.a.createElement("br",null),r.a.createElement(q.a,{variant:"contained",color:"primary",onClick:function(){k("Logging in..."),A.authenticate({username:n,password:i},(function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t?e.push("/app"):(k("Log In"),b(a),d(!0))}))}},y),r.a.createElement(q.a,{color:"secondary",onClick:function(){e.push("/login")}},"Don't have an account?"))))))}var $=a(233),Q=a(245);a(148);function X(){var e=Object(Y.g)(),t=r.a.useState(""),a=Object(B.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),s=Object(B.a)(c,2),i=s[0],l=s[1],u=r.a.useState(""),h=Object(B.a)(u,2),m=h[0],d=h[1],p=r.a.useState(""),g=Object(B.a)(p,2),f=g[0],b=g[1],v=r.a.useState(""),E=Object(B.a)(v,2),y=(E[0],E[1],r.a.useState(!1)),k=Object(B.a)(y,2),O=k[0],j=k[1],w=r.a.useState(""),S=Object(B.a)(w,2),C=S[0],x=S[1],M=r.a.useState(!1),T=Object(B.a)(M,2),I=T[0],N=T[1],H=function(e,t){"clickaway"!==t&&j(!1)};return r.a.createElement("div",{className:"container"},r.a.createElement(F.a,{open:O,autoHideDuration:6e3,onClose:H},r.a.createElement(G.a,{onClose:H,severity:"error"},"Error! ",C)),r.a.createElement(J.a,{className:"square",elevation:3,square:!0},r.a.createElement("div",{className:"content"},r.a.createElement(K.a,{display:"flex",style:{height:"100%"},flexDirection:"column",alignItems:"center",justifyContent:"center",className:"box"},r.a.createElement("h1",null,"Register!"),r.a.createElement("div",{className:"buttonContainer"},r.a.createElement(V.a,{placeholder:"Username",onChange:function(e){return o(e.target.value)}}),r.a.createElement(V.a,{placeholder:"Real Name",onChange:function(e){return l(e.target.value)}}),r.a.createElement(V.a,{placeholder:"Password",type:"password",onChange:function(e){return d(e.target.value)}}),r.a.createElement(V.a,{placeholder:"Email",onChange:function(e){return b(e.target.value)}}),r.a.createElement($.a,{control:r.a.createElement(Q.a,{checked:I,onChange:function(e){N(e.target.checked)}}),label:"Will you provide food?"}),r.a.createElement(q.a,{variant:"contained",color:"primary",onClick:function(){A.registerUser({username:n,realName:i,password:m,email:f,isFoodProvider:I},(function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t?e.push("/login"):(x(a),j(!0))}))}},"Register"),r.a.createElement(q.a,{color:"secondary",onClick:function(){e.push("/login")}},"Already have an account?"))))))}var _=a(239),ee=a(117),te=a.n(ee),ae=a(118),ne=a.n(ae),re=a(246),oe=a(231),ce=a(234),se=a(236),ie=a(235),le=a(237),ue=a(238),he=a(42),me=a(116),de=a.n(me),pe=new P.a,ge=function(){function e(){var t=this;Object(l.a)(this,e),this.socket=de.a.connect(),this.socket.on("connect",(function(){t.socket.emit("authenticate",pe.get("token")),console.log("connect")})),this.socket.on("error",(function(e){console.error("socket.io error: "+e)}))}return Object(u.a)(e,[{key:"registerErrorHandlers",value:function(e){var t=e.onSendMessageError,a=e.onAuthError,n=e.onUnknownError;this.socket.on("serverError",(function(e){switch(e.cause){case"auth":a(e.details);break;case"sentmsg":t(e.details);break;default:n(e.cause)}}))}},{key:"registerMessageHandler",value:function(e){this.socket.on("message",(function(t){console.log(t),e(t)}))}},{key:"sendMessage",value:function(e,t){console.log("sending msg"),this.socket.emit("message",{recipientId:t,message:e})}}]),e}(),fe=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={userInput:"",chatHistory:[]},n.handleKey=n.handleKey.bind(Object(he.a)(n)),n.onReceiveMessage=n.onReceiveMessage.bind(Object(he.a)(n)),n}return Object(u.a)(a,[{key:"handleKey",value:function(e){"Enter"==e.key&&(console.log(this.state.userInput),this.state.userInput&&this.props.sendMessage(this.state.userInput,this.props.match.params.senderId))}},{key:"onReceiveMessage",value:function(e){this.setState({chatHistory:this.state.chatHistory.concat([e])})}},{key:"componentWillMount",value:function(){this.props.registerMessageHandler(this.onReceiveMessage),this.props.recentlyTalkedTo.includes(this.props.match.params.senderId)&&(this.props.updateRecentlyTalkedTo(this.props.match.params.senderId),console.log(this.props))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"chatContainer"},r.a.createElement(oe.a,null,this.state.chatHistory.map((function(e){return r.a.createElement(ce.a,null,r.a.createElement(ie.a,{primary:e.senderName,secondary:e.message}))}))),r.a.createElement(V.a,{id:"messageInput",label:"Enter a message",placeholder:"Message:",onKeyPress:this.handleKey,value:this.state.userInput,onChange:function(t){return e.setState({userInput:t.target.value})}}))}}]),a}(r.a.Component),be=Object(Y.h)(fe),ve=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).client=new ge,n.state={recentlyTalkedTo:["Jeff","Bob","Kyle"]},n.registerMessageHandler=n.registerMessageHandler.bind(Object(he.a)(n)),n.sendMessage=n.sendMessage.bind(Object(he.a)(n)),n}return Object(u.a)(a,[{key:"registerMessageHandler",value:function(e){this.client.registerMessageHandler(e)}},{key:"sendMessage",value:function(e,t){this.client.sendMessage(e,t)}},{key:"componentWillMount",value:function(){}},{key:"addToRecentlyTalkedTo",value:function(e){this.setState({recentlyTalkedTo:this.state.recentlyTalkedTo.concat([e])})}},{key:"render",value:function(){return r.a.createElement(Y.d,null,r.a.createElement(Y.b,{exact:!0,path:this.props.match.path},r.a.createElement(oe.a,null,this.state.recentlyTalkedTo.map((function(e){return r.a.createElement("p",null,e)})))),r.a.createElement(Y.b,{path:"".concat(this.props.match.path,"/:senderId")},r.a.createElement(be,{sendMessage:this.sendMessage,registerMessageHandler:this.registerMessageHandler,recentlyTalkedTo:this.state.recentlyTalkedTo,updateRecentlyTalkedTo:this.addToRecentlyTalkedTo})))}}]),a}(r.a.Component),Ee=Object(Y.h)(Object(b.a)((function(e){return{root:{width:"100%",height:"100%",maxWidth:"36ch",backgroundColor:e.palette.background.paper},inline:{display:"inline"}}}))(ve)),ye=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={drawerOpen:!1},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{flexGrow:1,width:"100%",height:"100%"}},r.a.createElement(re.a,{anchor:"left",open:this.state.drawerOpen,onClose:function(){e.setState({drawerOpen:!1})}},r.a.createElement("div",{style:{width:300},onClick:function(){e.setState({drawerOpen:!1})},onKeyDown:function(){e.setState({drawerOpen:!1})}},r.a.createElement(oe.a,null,r.a.createElement(s.b,{to:"".concat(this.props.match.url),style:{textDecoration:"none",color:"black"}},r.a.createElement(ce.a,{button:!0,key:"Map"},r.a.createElement(se.a,null,r.a.createElement(te.a,null)),r.a.createElement(ie.a,{primary:"Map"}))),r.a.createElement(s.b,{to:"".concat(this.props.match.url,"/chat"),style:{textDecoration:"none",color:"black"}},r.a.createElement(ce.a,{button:!0,key:"Messaging"},r.a.createElement(se.a,null,r.a.createElement(M.a,null)),r.a.createElement(ie.a,{primary:"Messaging"})))))),r.a.createElement(le.a,{position:"sticky",style:{zIndex:402}},r.a.createElement(ue.a,null,r.a.createElement(w.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:function(){e.setState({drawerOpen:!0})}},r.a.createElement(ne.a,null)),r.a.createElement(S.a,{variant:"h6",style:{flexGrow:1}},"FoodSeek"),r.a.createElement(q.a,{onClick:function(){A.logout((function(){e.props.history.push("/")}))},color:"inherit"},"Logout"))),r.a.createElement(Y.d,null,r.a.createElement(Y.b,{exact:!0,path:this.props.match.path},r.a.createElement(W,null)),r.a.createElement(Y.b,{path:"".concat(this.props.match.path,"/chat")},r.a.createElement(Ee,null))))}}]),a}(r.a.Component),ke=Object(Y.h)(ye);a(181),r.a.Component,a(182);function Oe(e){var t=e.children,a=Object(i.a)(e,["children"]);return r.a.createElement(Y.b,Object.assign({},a,{render:function(e){var a=e.location;return A.isAuthenticated()?t:r.a.createElement(Y.a,{to:{pathname:"/login",state:{from:a}}})}}))}function je(e){var t=e.children,a=Object(i.a)(e,["children"]);return r.a.createElement(Y.b,Object.assign({},a,{render:function(e){var a=e.location;return A.isAuthenticated()?r.a.createElement(Y.a,{to:{pathname:"/app",state:{from:a}}}):t}}))}var we=function(){return r.a.createElement(Y.d,null,r.a.createElement(je,{exact:!0,path:"/"},r.a.createElement(Y.a,{to:"/login"})),r.a.createElement(je,{exact:!0,path:"/login"},r.a.createElement(_.a,{maxWidth:"sm",style:{height:"100vh"}},r.a.createElement(Z,null))),r.a.createElement(je,{exact:!0,path:"/register"},r.a.createElement(_.a,{maxWidth:"sm",style:{height:"100vh"}},r.a.createElement(X,null))),r.a.createElement(Oe,{path:"/app"},r.a.createElement(ke,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,null,r.a.createElement(we,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[133,1,2]]]);
//# sourceMappingURL=main.657b5391.chunk.js.map